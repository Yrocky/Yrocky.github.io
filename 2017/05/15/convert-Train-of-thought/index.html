<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>Yrocky's blog</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link href="/css/bootstrap.min.css" rel="stylesheet"><link href="/css/font-awesome.min.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"></head><body><div class="wrap"><nav class="page-navigation"><div class="nav-container"><div class="page-header-logo"><h1 class="prince-log"><a href="/" class="home-link">Yrocky</a></h1></div><button type="button" data-toggle="collapse" data-target=".main-nav-items" class="navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><ul class="collapse navbar-collapse main-nav-items"><li class="menu-item"><a href="/" target="_self">HOME</a></li><li class="menu-item"><a href="/archives/" target="_self">ARCHIVE</a></li></ul></div></nav><main class="prince-container"><div class="post"><article class="post-block"><h1 class="post-title">æ¢ä¸ªæ€è·¯ï¼Œè®©ç¼–ç¨‹æ›´åŠ æœ‰æ„æ€</h1><div class="post-info">2017 5æœˆ 15æ—¥</div><div class="post-entry"><p>è®°å½•ä¸€äº›è‡ªå·±å¹³å¸¸ä½¿ç”¨çš„å¦ç±»ç¼–ç¨‹æ–¹æ³•ï¼Œç»™ç¹å¤æ¯ç‡¥çš„ä»£ç å¹³æ·»ä¸€äº›ä¹è¶£ã€‚ä¸»è¦æ˜¯ä»ä¸€äº›å®é™…ä½¿ç”¨åœºæ™¯å‡ºå‘ï¼Œæ¢è®¨å¦‚ä½•ã€å·æ‡’ã€ï¼Œè®©æ—¶é—´ä¸é‚£ä¹ˆæµªè´¹åœ¨é‡å¤ä¿®æ”¹ä»£ç ä¸Šï¼Œå³ä½¿ä¿®æ”¹ä¹Ÿè¦è®©ä¿®æ”¹ä»£ç æ²¡é‚£ä¹ˆéº»çƒ¦ã€‚</p>
<blockquote>
<p>ç›®çš„ï¼š</p>
<ul>
<li>è§£å†³å†—ä½™ä»£ç </li>
<li>å‡å°‘æ ·æ¿ä»£ç çš„ä¹¦å†™</li>
<li>ä½¿ç”¨æ–¹ä¾¿</li>
</ul>
</blockquote>
<a id="more"></a>
<h3 id="1-å…³äºActionSheetç‚¹å‡»å“åº”ä¸åŒäº‹ä»¶çš„ä¸€ä¸ªä½¿ç”¨åœºæ™¯">1.å…³äºActionSheetç‚¹å‡»å“åº”ä¸åŒäº‹ä»¶çš„ä¸€ä¸ªä½¿ç”¨åœºæ™¯</h3><p>æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªåœºæ™¯æ˜¯ä¸€ä¸ªç•Œé¢ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¼¹å‡ºæ¥ä¸€ä¸ªActionSheetï¼Œé‡Œé¢æœ‰nå¤šä¸ªé€‰é¡¹å¯ä¾›ç”¨æˆ·æ¥é€‰æ‹©ã€‚ä»äº§å“è®¾è®¡çš„è§’åº¦æ¥è¯´ï¼Œå¯¹åº”çš„nç§æ“ä½œå°±æ˜¯ä¸€ä¸ªå¯æ€•çš„å®šæ—¶ç‚¸å¼¹ï¼Œä¸ç¡®å®šäº§å“æ˜¯ä¸æ˜¯ä¼šå¯¹è¿™nç§é€‰é¡¹è¿›è¡Œä¸€ä¸ªä»»æ€§çš„æ’åˆ—ï¼›è€Œä»å†™ä»£ç çš„è§’åº¦æ¥è¯´ï¼Œå¯¹äºè¿™nç§æ“ä½œï¼Œå†™ä¸€ä¸ªif-elseæˆ–è€…switch-caseæ˜¯ä¸€ä¸ªæ­£ç¡®çš„é€‰æ‹©ï¼Œä½†æ˜¯å†™ä¸‹æ¥ä½ å°±ä¼šå‘ç°ï¼šå†—ä½™ã€‚å†åŠ ä¸Šæœ‰å¯èƒ½ä¼šæœ‰æ’åºçš„æ”¹åŠ¨ï¼Œé‚£æ›´åŠ æ˜¯æ¯ç­æ€§çš„ä»£ç ã€‚</p>
<p>å¯¹äºè¿™ç§ç±»å‹çš„åœ°æ–¹ï¼Œæ²¡æœ‰å¿…è¦èŠ±è´¹å¤ªå¤šç²¾åŠ›æ¥ä¹¦å†™ä»¥åŠç»´æŠ¤ä»£ç ï¼Œéœ€è¦çš„æ˜¯ç®€æ´ä¸”æ˜“ç»´æŠ¤ã€‚</p>
<p>å¯ä»¥è€ƒè™‘ä½¿ç”¨æ•°ç»„å°†åˆ†æ”¯çš„æ“ä½œè¿›è¡Œå­˜å‚¨ï¼Œç„¶ååœ¨ç‚¹å‡»é€‰æ‹©æ—¶å°±å¯ä»¥ç›´è§‚çš„è¿›è¡Œå…¶å¯¹åº”çš„æ“ä½œã€‚å¯æƒœåœ¨ ä¸­ï¼Œé€‰æ‹©å­<code>@selector</code>æ—¢ä¸æ˜¯åŸºç¡€æ•°æ®ç±»å‹ä¹Ÿä¸æ˜¯å¯¹è±¡ï¼Œæ˜¯ä¸èƒ½å¤Ÿä½¿ç”¨æ•°ç»„å­˜å‚¨çš„ï¼Œé‚£ä¹ˆå°±åªèƒ½ä½¿ç”¨Cæ•°ç»„æ¥å­˜å‚¨äº†ï¼Œå†™å‡ºæ¥å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-(<span class="keyword">void</span>)actionSheet:(<span class="built_in">UIActionSheet</span> *)actionSheet clickedButtonAtIndex:(<span class="built_in">NSInteger</span>)buttonIndex &#123;</span><br><span class="line"></span><br><span class="line">Â Â Â  SEL selectors[] = &#123;</span><br><span class="line">Â Â Â Â Â Â Â  <span class="keyword">@selector</span>(insertRow),</span><br><span class="line">Â Â Â Â Â Â Â  <span class="keyword">@selector</span>(insertSection),</span><br><span class="line">Â Â Â Â Â Â Â  <span class="keyword">@selector</span>(deleteSection)</span><br><span class="line">Â Â Â  &#125;;</span><br><span class="line"></span><br><span class="line">Â Â Â  <span class="keyword">if</span> (buttonIndex &lt; <span class="keyword">sizeof</span>(selectors) / <span class="keyword">sizeof</span>(SEL)) &#123;</span><br><span class="line"></span><br><span class="line">Â Â Â Â Â Â Â  <span class="keyword">void</span>(*imp)(<span class="keyword">id</span>, SEL) = (<span class="keyword">typeof</span>(imp))[<span class="keyword">self</span> methodForSelector:selectors[buttonIndex]];</span><br><span class="line"></span><br><span class="line">Â Â Â Â Â Â Â  imp(<span class="keyword">self</span>, selectors[buttonIndex]);</span><br><span class="line">Â Â Â  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·è¿˜æ˜¯ä¼šå¸¦æ¥ä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªæ˜¯UIActionSheetçš„å®ç°å’Œæ–¹æ³•æ˜¯åˆ†å¼€å†™çš„ï¼Œç¬¬äºŒä¸ªæ˜¯å³ä½¿è¿™æ ·è¿˜æ˜¯éœ€è¦ç»´æŠ¤ä¸¤ä¸ªæ•°ç»„ï¼Œæ²¡æœ‰è¾¾åˆ°æ˜“ç»´æŠ¤çš„ç›®çš„ï¼Œä½†æ˜¯å¥½èµ–ä¹Ÿæ¯”ä»¥å‰ç®€å•äº†è®¸å¤šã€‚</p>
<p>ç¬¬ä¸€ä¸ªé—®é¢˜å¯ä»¥ä½¿ç”¨æœ€æ–°çš„<code>UIAlertController</code>çš„blockæ¥è§£å†³ï¼Œä½†æ˜¯è¿™æ— ç–‘åˆæ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œè¦å†™å¥½å¤šæ ·æ¿ä»£ç ï¼Œè¿™æ—¶å€™å°±éœ€è¦å¯¹UIAlertControllerè¿›è¡Œä¸€ä¸‹å°è£…ï¼Œä½¿å…¶ä½¿ç”¨èµ·æ¥æ›´åŠ ç®€æ´ã€‚</p>
<h3 id="2-å¯¹ç³»ç»Ÿçš„UIAlertControllerè¿›è¡Œå°è£…">2.å¯¹ç³»ç»Ÿçš„UIAlertControllerè¿›è¡Œå°è£…</h3><p>åœ¨iOS8.0ä¹‹åç³»ç»Ÿå°±ä¸æ¨èä½¿ç”¨UIAlertViewä»¥åŠUIActionSheetï¼Œè€Œä½¿ç”¨äº†ä¸€ä¸ªUIAlertControlleræ¥æ›¿æ¢ä»–ä»¬ä¸¤ä¸ªã€‚è¿™æ ·çš„åšæ³•å¯¹äºæ··ä¹±çš„è§†å›¾å±•ç¤ºå±‚çº§æ¥è¯´ç¡®å®æ˜¯ä¸€ä¸ªç¦éŸ³ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨blockçš„æ–¹å¼æ¥åœ¨ä¸€å¤„å¤„ç†å¯¹åº”çš„äº‹ä»¶ã€‚ä½†æ˜¯ï¼Œå¯¹äºæ–°çš„UIAlertControlleræ¥è¯´ï¼Œè¦å†™å¥½å¤šçš„æ ·æ¿ä»£ç ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ’ç‰ˆä¹Ÿä¸æ˜¯å¾ˆå¥½çœ‹ã€‚</p>
<p>åŸºäºå‡å°‘åŠ³åŠ¨åŠ›ä»¥åŠä¼˜åŒ–ä½¿ç”¨æ–¹å¼çš„ç›®çš„ï¼Œå¯¹ç³»ç»Ÿçš„UIAlertControllerè¿›è¡Œä¸€å±‚ç®€å•çš„å°è£…ã€‚æ€è·¯æ˜¯ä½¿ç”¨åè®®çš„æ–¹å¼æ¥çº¦å®šæ˜¯è¦æ˜¾ç¤ºçš„Alertä»¥åŠActionSheetç±»ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@protocol</span> HLLAlertActionSheetProtocol &lt;NSObject&gt;</span><br><span class="line"><span class="variable">@optional</span></span><br><span class="line">#pragma mark - config</span><br><span class="line"></span><br><span class="line">- (id&lt;HLLAlertActionSheetProtocol&gt;) <span class="attribute">title</span>:(NSString *)titile;</span><br><span class="line"><span class="selector-tag">-</span> (id&lt;HLLAlertActionSheetProtocol&gt;) <span class="selector-tag">message</span><span class="selector-pseudo">:(NSString</span> *)<span class="selector-tag">message</span>;</span><br><span class="line">...</span><br><span class="line">@<span class="selector-tag">end</span></span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ä¸€ä¸ª<code>HLLAlertActionSheet</code>ç±»æ¥ç”Ÿæˆå¯¹åº”çš„alertæˆ–è€…actionSheetç±»ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">HLLAlertActionSheet</span> : <span class="title">NSObject</span></span></span><br><span class="line">+ (<span class="keyword">id</span>&lt;HLLAlertActionSheetProtocol&gt;) alert;</span><br><span class="line">+ (<span class="keyword">id</span>&lt;HLLAlertActionSheetProtocol&gt;) actionSheet;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">HLLAlertActionSheet</span></span></span><br><span class="line"><span class="meta">#pragma mark - config</span></span><br><span class="line">+ (<span class="keyword">id</span>&lt;HLLAlertActionSheetProtocol&gt;) alert&#123;    </span><br><span class="line">    <span class="keyword">return</span> [HLLAlert alert];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>è€Œå¯¹äºalertä»¥åŠactionSheetç±»æ¥è¯´ï¼Œå†…éƒ¨ä½¿ç”¨ä¸€ä¸ªç§æœ‰ç±»æ¥å­˜å‚¨é€šè¿‡å®ç°åè®®ä¼ å…¥çš„è®¾ç½®ï¼Œç„¶ååœ¨<code>showIn:</code>æ–¹æ³•ä¸­å¯¹UIalertContrllerè¿›è¡Œåˆå§‹åŒ–ã€è®¾ç½®ä»¥åŠæ˜¾ç¤ºã€‚ä¸€ä¸ªalertç±»çš„éƒ¨åˆ†å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@interface</span> <span class="attribute">HLLAlert </span>: NSObject&lt;HLLAlertActionSheetProtocol&gt;</span><br><span class="line"></span><br><span class="line"><span class="variable">@property</span> (nonatomic ,strong) HLLAlertActionSheetModel * aModel;</span><br><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> <span class="selector-tag">-</span> <span class="selector-tag">config</span></span><br><span class="line">+ (HLLAlert *) <span class="selector-tag">alert</span>;</span><br><span class="line"><span class="variable">@end</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­å®ç°åè®®æ–¹æ³•æ—¶å€™æŠŠå½“å‰å®ä¾‹å¯¹è±¡ä¹Ÿè¿”å›å‡ºå»ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (HLLAlert *) title:(<span class="built_in">NSString</span> *)titile&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span>.aModel.title = titile;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·åœ¨ä½¿ç”¨çš„æ—¶å€™å¯ä»¥è¿™æ ·ï¼š</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[[[[[[[HLLAlertActionSheet alert]</span><br><span class="line">          title:@<span class="string">"ä¸¾æŠ¥è¿™ä¸ªäºº"</span>]</span><br><span class="line">         message:@<span class="string">"ç¡®å®šä¸¾æŠ¥å½“å‰ä¸»æ’­ç›´æ’­çš„å†…å®¹è¿è§„"</span>]</span><br><span class="line">        buttons:@[@<span class="string">"å–æ¶ˆ"</span>,@<span class="string">"ä¸¾æŠ¥"</span>]] style:UIAlertActionStyleCancel index:0]</span><br><span class="line">      showIn:self] fetchClick:^(<span class="name">NSInteger</span> index) &#123;</span><br><span class="line">        </span><br><span class="line">        if (<span class="name">index</span> = <span class="number">1</span>) &#123;// ä¸¾æŠ¥</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;]<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>å¯¹äºä¼ å…¥çš„ç”¨äºå¯é€‰æ“ä½œçš„å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼äºUIAlertViewåˆå§‹åŒ–çš„æ—¶å€™ä¸å®šä¸ªæ•°çš„å­—ç¬¦ä¸²ç±»å‹ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Default handle button type is `UIAlertActionStyleDefault`. */</span></span><br><span class="line">- (id&lt;HLLAlertActionSheetProtocol&gt;) <span class="keyword">buttons:(NSArray </span>*)<span class="keyword">buttons;</span></span><br><span class="line"><span class="keyword">/** </span>Explain some as above .è¿™ä¸ªé‡‡ç”¨å¤šå­—ç¬¦ä¸²çš„æ–¹å¼ä¼ é€’<span class="keyword">buttonsï¼Œä»¥åº”å¯¹button-fetchä¸å¯¹åº”çš„é—®é¢˜*/</span></span><br><span class="line"><span class="keyword">- </span>(id&lt;HLLAlertActionSheetProtocol&gt;) <span class="keyword">buttonTitles:(NSString </span>*)<span class="keyword">buttonTitles, </span>... NS_REQUIRES_NIL_TERMINATION<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>ç›®å‰ï¼Œæ²¡æœ‰åšå¯ä»¥æ·»åŠ UITextFieldçš„å°è£…ï¼Œåç»­æœ‰æ—¶é—´å†åšã€‚</p>
<h3 id="3-å…³äºä¸€ä¸ªå˜é‡çš„å®ä¾‹åŒ–æ–¹å¼">3.å…³äºä¸€ä¸ªå˜é‡çš„å®ä¾‹åŒ–æ–¹å¼</h3><p>å…¶å®è¿™æ˜¯<strong>å°æ‹¬å·å†…è”ç¬¦åˆè¡¨è¾¾å¼</strong>å†™æ³•â€“<code>A compound statement enclosed in parentheses.</code></p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨å¯¹ä¸€ä¸ªç±»çš„å¯¹è±¡å˜é‡è¿›è¡Œå®ä¾‹åŒ–çš„æ—¶å€™ï¼Œå¾€å¾€éœ€è¦å†™å¤§é‡çš„å…³äºè¿™ä¸ªå¯¹è±¡å˜é‡çš„è®¾ç½®å±æ€§ä»£ç ã€‚</p>
<p>è¿™ç§åšæ³•çš„æœ€å¤§çš„æ„ä¹‰æ˜¯å°†ä»£ç æ•´ç†åˆ†å—ï¼Œå°†åŒä¸€ä¸ªé€»è¾‘çš„ä»£ç æŠ±åœ¨ä¸€èµ·ï¼›åŒæ—¶å¯¹äºä¸€ä¸ªä¸éœ€è¦å¤ç”¨çš„å°æ®µé€»è¾‘ï¼Œå…å»äº†é‡é‡çº§å‡½æ•°çš„è°ƒç”¨ï¼š</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self.loginButton </span>= (&#123;</span><br><span class="line">Â Â Â Â Â Â Â  UIButton *<span class="keyword">button </span>= [UIButton <span class="keyword">buttonWithType:UIButtonTypeCustom];</span></span><br><span class="line"><span class="keyword">Â </span> Â  Â  Â  ...</span><br><span class="line">Â Â Â Â Â Â Â  <span class="keyword">button;</span></span><br><span class="line"><span class="keyword">Â </span>Â Â  &#125;)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<h3 id="4-ä½¿ç”¨ä½åŸŸè¿›è¡Œä»£ç†æ–¹æ³•å®ç°ä¸å¦çš„åˆ¤æ–­">4.ä½¿ç”¨ä½åŸŸè¿›è¡Œä»£ç†æ–¹æ³•å®ç°ä¸å¦çš„åˆ¤æ–­</h3><p>åœ¨ä½¿ç”¨ä»£ç†çš„æ—¶å€™éœ€è¦åˆ¤æ–­ä»£ç†ä»£ç†æ˜¯å¦å®ç°äº†åè®®æ–¹æ³•ï¼Œä¸€èˆ¬çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨if-elseè¿›è¡Œä¹¦å†™ï¼Œä½†æ˜¯è¿™æ ·çš„åˆ‡ç –ä»£ç æ¯”è¾ƒæ¯ç‡¥ï¼Œä¹Ÿæ²¡æœ‰ä¸€ç‚¹å„¿æŠ€æœ¯æ€§å¯è¨€ï¼Œæ‰€ä»¥æŒ‰ç…§EOCä¸­çš„æ–¹æ³•å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•è¿›è¡Œä¹¦å†™ï¼Œ</p>
<p>ä½¿ç”¨ç»“æ„ä½“è¿›è¡Œä½çš„æ ‡è®°ä½ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@<span class="function">interface <span class="title">KKGestureLockView</span> <span class="params">()</span></span>&#123;</span><br><span class="line">Â Â Â  <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">Â Â Â Â Â Â Â  <span class="keyword">unsigned</span> <span class="keyword">int</span> didBeginWithPasscode :<span class="number">1</span>;</span><br><span class="line">Â Â Â Â Â Â Â  <span class="keyword">unsigned</span> <span class="keyword">int</span> didEndWithPasscode : <span class="number">1</span>;</span><br><span class="line">Â Â Â Â Â Â Â  <span class="keyword">unsigned</span> <span class="keyword">int</span> didCanceled : <span class="number">1</span>;</span><br><span class="line">Â Â Â  &#125; _delegateFlags;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è®¾ç½®ä»£ç†çš„æ—¶å€™è¿›è¡Œåˆ¤æ–­ä»£ç†æ˜¯å¦å®ç°äº†ç›¸å…³åè®®æ–¹æ³•ï¼Œç„¶åè®¾ç½®æ ‡è®°ä½ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)<span class="string">setDelegate:</span>(id&lt;KKGestureLockViewDelegate&gt;)delegate&#123;</span><br><span class="line"></span><br><span class="line">Â Â Â  _delegate = delegate;Â </span><br><span class="line"></span><br><span class="line">Â Â Â  _delegateFlags.didBeginWithPasscode = [delegate <span class="string">respondsToSelector:</span><span class="meta">@selector</span>(<span class="string">gestureLockView:</span><span class="string">didBeginWithPasscode:</span>)];</span><br><span class="line">Â Â Â  _delegateFlags.didEndWithPasscode = ã€‚ã€‚ã€‚</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ ‡è®°ä½åˆ¤æ–­æ˜¯å¦å®ç°åè®®æ–¹æ³•ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (_delegateFlags.didBeginWithPasscode) &#123;</span><br><span class="line"></span><br><span class="line">Â Â Â Â Â [self.delegate <span class="string">gestureLockView:</span>self <span class="string">didBeginWithPasscode:</span>[NSString <span class="string">stringWithFormat:</span>@<span class="string">"%zd"</span>,touchedButton.tag]];</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-æ”¹è¿›å±æ€§å­—ç¬¦ä¸²">5.æ”¹è¿›å±æ€§å­—ç¬¦ä¸²</h3><p>åœ¨ä½¿ç”¨å±æ€§å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä¸è®ºç”Ÿæˆè¿˜æ˜¯å¯¹å·²çŸ¥å­—ç¬¦ä¸²è¿›è¡ŒæŸäº›å­—æ®µè®¾ç½®å±æ€§ï¼Œéƒ½æ˜¯ä¸€ä»¶å¾ˆéº»çƒ¦çš„äº‹æƒ…ï¼Œè¦ç¼–å†™å¤§æ®µçš„æ ·æ¿ä»£ç å®åœ¨æ˜¯æµªè´¹æ—¶é—´ã€‚å¯¹ç”Ÿæˆé…ç½®å±æ€§å­—ç¬¦ä¸²çš„æ“ä½œè¿›è¡Œç®€åŒ–ï¼Œä½†æ˜¯ä¸è¦æ”¾å¼ƒç³»ç»Ÿæä¾›çš„è®¾ç½®æ–¹æ³•ï¼Œå› ä¸ºç³»ç»Ÿçš„éƒ½ä¼šç”¨ï¼Œæ”¹è¿›ä¹‹åä¼šå¥½ä¸Šæ‰‹ã€‚</p>
<p>æ”¹è¿›ç”Ÿæˆå±æ€§å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œç®€å•éœ€æ±‚æ¯”å¦‚ä¸€ä¸ªä¸ªçš„æ‹¼æ¥ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// black 16</span></span><br><span class="line">+ (<span class="keyword">instancetype</span>) builder;</span><br><span class="line"><span class="comment">// &#123; NS...AttributeName : (id)value&#125;</span></span><br><span class="line">+ (<span class="keyword">instancetype</span>) builderWithDefaultStyle:(<span class="built_in">NSDictionary</span> *)defaultStyle;</span><br><span class="line"></span><br><span class="line">- (HLLAttributedBuilder *) appendString:(<span class="built_in">NSString</span> *)string;</span><br><span class="line">- (HLLAttributedBuilder *(^)(<span class="built_in">NSString</span> *str)) appendString;</span><br><span class="line"></span><br><span class="line">- (HLLAttributedBuilder *) appendString:(<span class="built_in">NSString</span> *)string forStyle:(<span class="built_in">NSDictionary</span> *)style;</span><br><span class="line">- (HLLAttributedBuilder *(^)(<span class="built_in">NSString</span> *str ,<span class="built_in">NSDictionary</span> *style)) appendStringAndStyle;</span><br></pre></td></tr></table></figure>
<p>æ›´å¸¸è§çš„éœ€æ±‚æ¯”å¦‚ï¼ŒæŸ¥æ‰¾ç‰¹å®šçš„å­—ç¬¦ä¸²ç„¶åè¿›è¡Œå±æ€§è®¾ç½®ã€‚ä¸€ç§æƒ…å½¢æ˜¯ï¼Œå·²æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œéœ€è¦å¯¹å…¶ä¸­çš„æŸä¸€äº›å­—ç¬¦ä¸²è¿›è¡Œå±æ€§å­—ç¬¦ä¸²è®¾ç½®ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">instancetype) </span><span class="keyword">builderWithString:(NSString </span>*)<span class="keyword">originalString;</span></span><br><span class="line"><span class="keyword">+ </span>(<span class="keyword">instancetype) </span><span class="keyword">builderWithString:(NSString </span>*)<span class="keyword">originalString </span>defaultStyle:(NSDictionary *)defaultStyle<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">- (HLLAttributedBuilder *) configString:(NSString *)string forStyle:(NSDictionary *)style<span class="comment">;</span></span><br><span class="line">- (HLLAttributedBuilder *(^)(NSString *str ,NSDictionary *style)) configStringAndStyle<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>æ ¹æ®ä¸Šé¢è®¾ç½®çš„å±æ€§ç„¶åè°ƒç”¨<code>- (NSAttributedString *) attributedString;</code>æ–¹æ³•å°±å¯ä»¥ç”Ÿæˆå¯¹åº”çš„å±æ€§å­—ç¬¦ä¸²ã€‚</p>
<p>ä½¿ç”¨ä¾‹å­</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> * display = <span class="string">@"hello = nihao = Hello = ä½ å¥½ = nihao"</span>;</span><br><span class="line">attachment æ˜¯<span class="built_in">NSTextAttachment</span>ç±»çš„å®ä¾‹</span><br><span class="line">[[[[[[[HLLAttributedBuilder builderWithString:display]</span><br><span class="line">                      configString:<span class="string">@"hello"</span> forStyle:@&#123;<span class="built_in">NSUnderlineColorAttributeName</span>:[<span class="built_in">UIColor</span> redColor],</span><br><span class="line">                                                       <span class="built_in">NSUnderlineStyleAttributeName</span>:@<span class="number">1</span>,</span><br><span class="line">                                                       <span class="built_in">NSForegroundColorAttributeName</span>:[<span class="built_in">UIColor</span> orangeColor]&#125;]</span><br><span class="line">                     configString:<span class="string">@"nihao"</span> forStyle:@&#123;<span class="built_in">NSStrokeColorAttributeName</span>:[<span class="built_in">UIColor</span> redColor],</span><br><span class="line">                                                      <span class="built_in">NSStrokeWidthAttributeName</span>:@<span class="number">1</span>&#125;]</span><br><span class="line">                    configString:<span class="string">@"H"</span> forStyle:@&#123;<span class="built_in">NSBackgroundColorAttributeName</span>:[<span class="built_in">UIColor</span> greenColor]&#125;]</span><br><span class="line">                   appendAttachment:attachment]</span><br><span class="line">                  appendString:<span class="string">@"å¨ƒå¤§å–œ"</span>]</span><br><span class="line">                 attributedString];</span><br></pre></td></tr></table></figure>
<p>å†…éƒ¨ä¸»è¦æ˜¯ä½¿ç”¨ç§æœ‰ç±»æ¥è®°å½•æ¯æ¬¡çš„å±æ€§è®¾ç½®ï¼Œç”¨<strong>attributedString</strong>å±æ€§æ¥è®°å½•ï¼Œç„¶åä½¿ç”¨æ•°ç»„æ¥ä¿å­˜è¿™ä¸ªç§æœ‰å®ä¾‹ã€‚å¯¹äº<code>-append...</code>æ–¹å¼ï¼Œæ¯æ¬¡å°†è®°å½•çš„å¯¹è±¡æ”¾å…¥æ•°ç»„ï¼Œè€Œå¯¹äº<code>-configString...</code>æ–¹å¼ï¼Œåˆ™æ˜¯æ•°ç»„ä¸­ä¸€ç›´åªæœ‰ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<h3 id="6-ç®€åŒ–NSUserDefaultsçš„ä½¿ç”¨">6.ç®€åŒ–NSUserDefaultsçš„ä½¿ç”¨</h3><p>NSUserDefaultsä¸€èˆ¬ç”¨æ¥ä¿å­˜ä¸€äº›ç®€å•çš„æ•°æ®åˆ°æœ¬åœ°ï¼Œä½†æ˜¯å†™èµ·æ¥ä¼šå†™å¾ˆå¤šçš„æ ·æ¿ä»£ç ï¼Œæ²¡æœ‰ä»€ä¹ˆæŠ€æœ¯å«é‡ï¼Œç¨å¾®ä¸æ³¨æ„è¿˜ä¼šå‡ºé”™ï¼Œè¿™é‡Œå°†NSUserDefaultsæ·»åŠ ä¸€ä¸ªåˆ†ç±»ï¼Œç®€åŒ–ä»–çš„ä½¿ç”¨ã€‚</p>
<p>ç»“åˆå®å’Œblockçš„ç‰¹æ€§ï¼Œå¯ä»¥å¾ˆä¼˜é›…çš„ä½¿ç”¨ç‚¹è¯­æ³•è°ƒç”¨ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#define MM_UserDefaults [NSUserDefaults standardUserDefaults]</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSUserDefaults</span> (<span class="title">MM_Tools</span>)</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSUserDefaults</span> *(^)(<span class="built_in">NSString</span> *key,<span class="built_in">BOOL</span> value))mm_addBool;</span><br><span class="line">- (<span class="built_in">BOOL</span>(^)(<span class="built_in">NSString</span> *))mm_boolValue;</span><br><span class="line">...</span><br><span class="line">- (<span class="built_in">NSUserDefaults</span> *(^)(<span class="built_in">NSString</span> *key,<span class="keyword">id</span> value))mm_addObject;</span><br><span class="line">- (<span class="keyword">id</span>(^)(<span class="built_in">NSString</span> *))mm_objectValue;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>å¯¹åº”çš„å®ç°</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSUserDefaults</span> *(^)(<span class="built_in">NSString</span> *,<span class="built_in">BOOL</span>))mm_addBool&#123;</span><br><span class="line">    <span class="keyword">return</span> ^<span class="built_in">NSUserDefaults</span> *(<span class="built_in">NSString</span> *key,<span class="built_in">BOOL</span> value)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.mm_addObject(key,@(value));</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="built_in">BOOL</span>(^)(<span class="built_in">NSString</span> *))mm_boolValue&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ^<span class="built_in">BOOL</span>(<span class="built_in">NSString</span> *key)&#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="keyword">self</span>.mm_objectValue(key) boolValue];</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">- (<span class="built_in">NSUserDefaults</span> *(^)(<span class="built_in">NSString</span> *,<span class="keyword">id</span>))mm_addObject&#123;</span><br><span class="line">    <span class="keyword">return</span> ^<span class="built_in">NSUserDefaults</span> *(<span class="built_in">NSString</span> *key,<span class="keyword">id</span> value)&#123;</span><br><span class="line">        [<span class="keyword">self</span> setValue:value forKey:key];</span><br><span class="line">        [<span class="keyword">self</span> synchronize];</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="keyword">id</span>(^)(<span class="built_in">NSString</span> *))mm_objectValue&#123;</span><br><span class="line">    <span class="keyword">return</span> ^<span class="keyword">id</span>(<span class="built_in">NSString</span> *key)&#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="keyword">self</span> valueForKey:key];</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨çš„æ—¶å€™å¯ä»¥è¿™æ ·</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">MM_UserDefaults</span><span class="selector-class">.mm_addBool</span>(@"<span class="keyword">some_bool_key</span>",<span class="keyword">YES</span>);</span><br><span class="line"><span class="selector-tag">MM_UserDefaults</span><span class="selector-class">.mm_boolValue</span>(@"<span class="keyword">some_bool_key</span>");</span><br></pre></td></tr></table></figure>
<h3 id="7-ä¼˜é›…çš„ä¸ºåˆ†ç±»æ·»åŠ å±æ€§">7.ä¼˜é›…çš„ä¸ºåˆ†ç±»æ·»åŠ å±æ€§</h3><p>éš¾ä¿ä¼šé‡åˆ°è¦åœ¨æŸä¸€ä¸ªåˆ†ç±»ä¸­æ·»åŠ å¥½å¤šçš„å±æ€§ï¼Œç»“åˆruntimeå¯ä»¥å®ç°ï¼Œä½†æ˜¯è¦å†™å¥½å¤šçš„é‡å¤ä»£ç ï¼Œå¯¹äºè¿™äº›é‡å¤ä»£ç ï¼Œä½¿ç”¨å®æ¥ç»Ÿä¸€æ›¿æ¢æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ã€‚</p>
<p>å€Ÿç”±ä¸‹é¢æ–‡ç« ä¸­çš„æ–¹æ³•ï¼Œå®ç°ä¸ºä¸€ä¸ªå•ä¾‹æ·»åŠ ä¸€äº›å±æ€§ï¼Œç»“åˆä¸Šé¢çš„<code>MM_UserDefaults</code>å¯¹è¿™äº›å±æ€§è¿›è¡Œæœ¬åœ°å­˜å‚¨</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@interface</span> MM_Manager (UserDefaults)</span><br><span class="line"></span><br><span class="line">mm_property_basicDataType(BOOL, openDebugerToggle</span><br><span class="line">...</span><br><span class="line"><span class="variable">@end</span></span><br><span class="line"></span><br><span class="line"><span class="variable">@implementation</span> MM_Manager (UserDefaults)</span><br><span class="line">                          </span><br><span class="line">mm_def_property_basicDataType(BOOL, openDebugerToggle)</span><br><span class="line"></span><br><span class="line"><span class="variable">@end</span></span><br></pre></td></tr></table></figure>
<p>å®é‡Œé¢æœ‰ä¸¤ä¸ªå¯¹å½“å‰ç±»çš„æ–¹æ³•éœ€è¦æ·»åŠ </p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MM_Manager</span> (<span class="title">MM_associated</span>)</span></span><br><span class="line">- (<span class="keyword">id</span>)mm_getAssociatedObjectForKey:(<span class="keyword">const</span> <span class="keyword">char</span> *)key</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> * propName = key;</span><br><span class="line">    <span class="built_in">NSString</span> * key_ = [<span class="built_in">NSString</span> stringWithUTF8String:propName];</span><br><span class="line">    <span class="keyword">return</span> MM_UserDefaults.mm_objectValue(key_);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">id</span>)mm_setAssignAssociatedObject:(<span class="keyword">id</span>)obj forKey:(<span class="keyword">const</span> <span class="keyword">char</span> *)key;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> * propName = key;</span><br><span class="line">    <span class="built_in">NSString</span> * key_ = [<span class="built_in">NSString</span> stringWithUTF8String:propName];</span><br><span class="line">    <span class="keyword">id</span> oldValue = MM_UserDefaults.mm_objectValue(key_);</span><br><span class="line">    MM_UserDefaults.mm_addObject(key_ ,obj);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"userdefault:%@ for key:%@"</span>,obj,key_);</span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>è¦äº†è§£å¦‚ä½•ä½¿ç”¨å®ï¼Œè¯·å‚è€ƒğŸ‘‡çš„æ–‡ç« </p>
<p><a href="http://blog.csdn.net/uxyheaven/article/details/46789065" target="_blank" rel="noopener">ä¸ºåˆ†ç±»æ·»åŠ è¯•ç”¨å®æ·»åŠ å±æ€§</a></p>
<p><a href="http://www.jianshu.com/p/4c5613e256c8" target="_blank" rel="noopener">å¯¹ReactiveCocoaä¸­å®çš„è§£é‡Š</a></p>
<h3 id="8-åˆç†çš„ä¿®æ”¹readonlyå±æ€§ä»¥åŠä¾¿æ·çš„è¿›è¡Œcopyæ“ä½œ">8.åˆç†çš„ä¿®æ”¹readonlyå±æ€§ä»¥åŠä¾¿æ·çš„è¿›è¡Œcopyæ“ä½œ</h3><p>ä¸€ä¸ªåœºæ™¯æ˜¯ä¸€ä¸ªç±»é€šè¿‡ä¸€ä¸ªå‚æ•°åˆå§‹åŒ–ï¼Œç„¶åä»–ä¹Ÿæœ‰ä¸€ä¸ªå±æ€§å’Œè¿™ä¸ªå‚æ•°ä¸€æ ·ï¼Œä½†æ˜¯<strong>æ˜¯readonly</strong>çš„ï¼Œ</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Reminder</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readonly</span>) <span class="built_in">NSString</span> *title;</span><br><span class="line">- (<span class="keyword">instancetype</span>)initWith:(<span class="built_in">NSString</span> *)title;</span><br><span class="line"></span><br><span class="line">@impeletation</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithTitle:(<span class="built_in">NSString</span> *)title </span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">    _title = title;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°±æ²¡æœ‰åŠæ³•ä¿®æ”¹è¿™ä¸ª<code>title</code>å±æ€§äº†ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡KVCï¼Œä½†æ˜¯ï¼Œæƒ³è±¡ä¸€ä¸‹æœ‰å¾ˆå¤šå‚æ•°çš„æ—¶å€™ï¼Œé‚£å°±æ˜¯æ¯”è¾ƒéº»çƒ¦çš„äº‹æƒ…äº†ã€‚å…·ä½“è¿˜æœ‰å…¶ä»–ä»€ä¹ˆéº»çƒ¦çš„æƒ…å†µï¼Œå¯ä»¥<a href="http://holko.pl/2015/05/12/immutable-object-initialization/" target="_blank" rel="noopener">å‚è€ƒè¿™ä¸ªåšæ–‡</a>ï¼Œé‡Œé¢ä¹Ÿæœ‰åº”å¯¹éº»çƒ¦åœºæ™¯ä¸‹çš„è§£å†³åŠæ³•ï¼Œè¿™äº›åŠæ³•éƒ½ä¸æ˜¯å¾ˆä¼˜é›…ï¼Œæœ€åé€šè¿‡runtimeç‰¹æ€§åšå‡ºäº†ä¸€ä¸ªå°å·§çš„å·¥å…·ã€‚</p>
<p>é‡Œé¢ä¸»è¦ç”¨åˆ°äº†<code>runtime</code>æ¥è·å–ç±»çš„æ‰€æœ‰å±æ€§ã€æ¶ˆæ¯ä¼ é€’ã€<code>KVC</code>æ¥å¯¹æ‰€æœ‰çš„å±æ€§è¿›è¡Œèµ‹å€¼ï¼Œä¸»è¦æ¶‰åŠåˆ°ä¸¤ä¸ªæ–¹æ³•</p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- <span class="params">(NSMethodSignature *)</span>methodSignatureForSelector:<span class="params">(SEL)</span>sel;</span><br><span class="line"></span><br><span class="line">- <span class="params">(void)</span>forwardInvocation:<span class="params">(NSInvocation *)</span>invocation;</span><br></pre></td></tr></table></figure>
<p>å…·ä½“<code>NSInvocation</code>çš„ç”¨æ³•ï¼Œä¸€æœä¸€å¤§å †ï¼Œè¿™ä¸æ˜¯é‡ç‚¹ï¼Œæ ¹æ®ä»¥ä¸Šä¸¤ä¸ªæ–¹æ³•å¯ä»¥å°†targetå¯¹è±¡è¿›è¡ŒKVCè®¾ç½®readonlyå±æ€§ï¼Œæœ€åçš„å·¥å…·æ–¹æ³•æœ‰ä¸¤ä¸ªï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSObject</span> (<span class="title">AHKBuilder</span>)</span></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithBuilder_ahk:(<span class="keyword">void</span> (^)(<span class="keyword">id</span>))builderBlock;</span><br><span class="line">- (<span class="keyword">instancetype</span>)copyWithBuilder_ahk:(<span class="keyword">void</span> (^)(<span class="keyword">id</span>))builderBlock;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>æœ‰ä¸¤ç§ä½¿ç”¨æ–¹æ³•ï¼Œç¬¬ä¸€ç§å°±æ˜¯ä¸ºreadonlyå±æ€§è®¾ç½®å€¼</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">MM_testObjBuilder</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span> ,<span class="keyword">retain</span> ,<span class="keyword">readwrite</span>) <span class="built_in">NSString</span> * title;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MM_testObj</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span> ,<span class="keyword">copy</span>) <span class="built_in">NSString</span> * detail;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span> ,<span class="keyword">retain</span> ,<span class="keyword">readonly</span>) <span class="built_in">NSString</span> * title;</span><br><span class="line">- (<span class="keyword">instancetype</span>) initWith:(<span class="built_in">NSString</span> *)title;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line">MM_testObj * obj = [[MM_testObj alloc] initWith:<span class="string">@"Name"</span>];</span><br><span class="line">obj.detail = <span class="string">@"Detail"</span>;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@/%@"</span>,obj.title,obj.detail);<span class="comment">// Name/Detail</span></span><br><span class="line"></span><br><span class="line">MM_testObj * obj_1 = [[MM_testObj alloc] initWithBuilder_ahk:^(<span class="keyword">id</span>&lt;MM_testObjBuilder&gt;builder) &#123;</span><br><span class="line">    builder.title = <span class="string">@"Name_1"</span>;</span><br><span class="line">&#125;];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@/%@"</span>,obj_1.title,obj_1.detail);<span class="comment">// Name_1/(null)</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§æ˜¯å¯¹ä¸€ä¸ªå·²æœ‰å¯¹è±¡è¿›è¡Œæ‹·è´ï¼Œè¯´æ˜¯æ‹·è´ï¼Œå…¶å®å°±æ˜¯æŒ¨ä¸ªå¯¹å±æ€§è¿›è¡Œèµ‹å€¼ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸éœ€è¦è¢«æ‹·è´çš„ç±»éµå®ˆ<code>NSCopying</code>åè®®</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MM_testObj * obj_2 = [obj copyWithBuilder_ahk:^(id&lt;MM_testObjBuilder&gt;<span class="keyword">builder) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;]<span class="comment">;</span></span><br><span class="line">NSLog(@<span class="string">"%@/%@"</span>,obj_2.title,obj_2.detail)<span class="comment">;// Name/Detail</span></span><br><span class="line"></span><br><span class="line">MM_testObj * obj_3 = [obj copyWithBuilder_ahk:^(id&lt;MM_testObjBuilder&gt;<span class="keyword">builder) </span>&#123;</span><br><span class="line">    <span class="keyword">builder.title </span>= @<span class="string">"Name_3"</span><span class="comment">;</span></span><br><span class="line">&#125;]<span class="comment">;</span></span><br><span class="line">NSLog(@<span class="string">"%@/%@"</span>,obj_3.title,obj_3.detail)<span class="comment">;// Name_3/Detail</span></span><br></pre></td></tr></table></figure>
<p>åœ¨æ­£å¸¸å¼€å‘ä¸­æ˜¯ä¸å¤ªä¼šç”¨åˆ°è¿™ç§æ“ä½œçš„ï¼Œåªä¸è¿‡æ˜¯å¯¹<strong>Builderæ¨¡å¼</strong>å’Œ<strong>runtime</strong>ã€<strong>NSInvocation</strong>çš„ä¸€ä¸ªå°ç»ƒä¹ ã€‚å½“ç„¶ï¼Œå¦‚æœåœ¨é€†å‘çš„æ—¶å€™éœ€è¦hookä¸€äº›ç±»ï¼Œé‚£å°±æ˜¯å¾ˆå®ç”¨çš„å·¥å…·äº†ã€‚</p>
<p><a href="http://holko.pl/2015/05/12/immutable-object-initialization/" target="_blank" rel="noopener">å‚è€ƒæ–‡ç« </a></p>
<p><a href="https://github.com/fastred/AHKBuilder" target="_blank" rel="noopener">ä»“åº“åœ°å€</a></p>
<hr>
<p>Continue update â€¦</p>
</div><div class="post-tags-box"><a class="tag-link" href="/tags/å­¦ä¹ /">å­¦ä¹ </a></div></article></div><div class="post-nav"><div class="prev-wrap col-md-6 col-xs-6"><i class="fa fa-angle-double-left"></i><a href="/2017/08/05/sketch/" class="prev-post">ä½¿ç”¨Sketchè¿›è¡Œè®¾è®¡å­¦ä¹ </a></div><div class="next-wrap col-md-6 col-xs-6"><a href="/2016/12/11/one-function/" class="next-post">ä¸€ä¸ªbugäº†è§£JSçš„æ ¸å¿ƒçŸ¥è¯†ç‚¹</a><i class="fa fa-angle-double-right"></i></div></div></main></div><footer><div class="copyright"><p>Crafted with <i class="fa fa-heart"></i> by&nbsp;Yrocky&nbsp;|&nbsp;<a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yiliashaw/hexo-theme-prince" target="_blank">Prince</a> by SHAW</p></div></footer><script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.0.47/jquery.fancybox.min.js"></script><script src="/js/script.js"></script></body></html>